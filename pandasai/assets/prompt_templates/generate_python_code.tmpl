You are provided with the following pandas DataFrames:

{dataframes}

<conversation>
{conversation}
</conversation>

This is the initial python function. Do not change the params. Given the context, use the right dataframes.
```python
{current_code}
```

Take a deep breath and reason step-by-step. Act as a senior data analyst.
Based on the last message in the conversation:
{advanced_reasoning}
- return the updated analyze_data function wrapped within ```python ```